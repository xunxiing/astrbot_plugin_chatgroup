# AstrBot 讨论组插件 (chatgroup)

![Version](https://img.shields.io/badge/version-0.1.0-blue)
![License](https://img.shields.io/badge/license-MIT-green)

> **免责声明**：作者本人真心不知道这个插件具体能做什么，但是感觉很有用就发布了。

## 简介

这是一个为AstrBot设计的讨论组工作流插件，实现了上下文裁剪与语义向量持久化存储功能，支持HTML渲染查看聚类话题。本插件可以自动分析聊天记录，识别话题并聚类，帮助用户更好地理解群聊中的讨论内容。

## 功能特点

- 上下文裁剪：智能提取聊天记录中的关键信息
- 语义向量持久化存储：将聊天内容转换为向量并长期保存
- 话题聚类：自动识别聊天中的不同话题并进行分组
- HTML渲染：生成美观的HTML报告展示聚类结果
- 支持多种嵌入模型：包括本地模型和云端API

## 安装

建议使用插件市场安装

## 使用方法

### 基本使用

1. 启动AstrBot
2. 插件会自动加载并开始工作
3. 在astrbot的配置面板中载入至少一个embedding provider
4. 在聊天中使用`/讨论`命令查看聚类话题

## 技术实现

插件主要包含以下组件：

- **数据处理**：消息解析、文本构建、内容过滤
- **嵌入模型**：支持本地和云端嵌入模型
- **聚类算法**：使用K-means和HDBSCAN进行话题聚类
- **分析模块**：提取话题关键词、生成话题名称
- **后处理**：优化聚类结果，填充用户信息

## 依赖项

- numpy>=1.24
- scikit-learn>=1.2
- requests>=2.31
- hdbscan>=0.8.36
- pandas>=1.5
- python-dateutil>=2.8.2
- beautifulsoup4>=4.12
- emoji>=2.10.0
- jieba>=0.42.1
- tqdm>=4.66
- python-dotenv>=1.0.1
- sentence-transformers>=2.2.2 (可选，用于本地嵌入)

## 贡献

欢迎提交Issue和Pull Request！

## 许可证

MIT License

## 作者

xunxiing

---

## **todo list**

~~优化性能开销，降低延迟到500ms以下（已实现）~~

对外暴露api以供其他插件调用

加入簇合并机制

优化性能开销，降低到400ms

> 再次强调：作者本人真心不知道这个插件具体能做什么qwq，作为一个插件没有应该有的完善的机制，作为一个总结插件没有完善的高效总结机制，作为主动回复完全没有机制，但是我会长期维护这个插件，期待未来可以发现用处吧

